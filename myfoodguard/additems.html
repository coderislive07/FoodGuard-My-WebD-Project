<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
      <link rel="stylesheet" href="index.css">
</head>
<body>

  <!-- navbar section  -->
       <nav class="navbar">
            <a href = "index.html"> <div class="logo">ğŸ¥¦ FoodGuard</div></a>
          <div class="threeBars" id="threeBars">
    â˜°
  </div>
        <ul class="nav-links">
            <li><a href="index.html" >ğŸ  Home</a></li>
      <li><a href="additems.html" class="active">â• Add Item</a></li>
      <li><a href="allitems.html">ğŸ“‹ All Items</a></li>
      <li><a href="settings.html">âš™ï¸ Settings</a></li>
        <div class="notification-bell" id="notificationBell">
    ğŸ””
    <span class="notification-count">0</span>
  </div>
        </ul>
        
    </nav>

    <!-- add items form  -->
    <section class="add-item-section">
  <h1>Add Food Items</h1>
  <form class="add-item-form" id="addItemForm">
    <div class="addItemsForm">
      <label for="itemName">Item Name</label>
      <input type="text" id="itemName" placeholder="e.g. Milk,Mangoes,Apples" required />
    </div>

    <div class="addItemsForm">
      <label for="category">Category</label>
      <select id="category" required>
        <option value="">Select Category</option>
        <option value="fruits">ğŸ Fruits</option>
        <option value="vegetables">ğŸ¥• Vegetables</option>
        <option value="dairy">ğŸ¥› Dairy</option>
        <option value="meat">ğŸ— Meat</option>
        <option value="beverages">ğŸ¥¤ Beverages</option>
        <option value="others">ğŸ½ Others</option>
      </select>
    </div>

    <div class="addItemsForm">
      <label for="quantity">Quantity</label>
      <input type="number" id="quantity" min="1" placeholder="e.g. 2" required />
    </div>

    <div class="addItemsForm">
      <label for="expiryDate">Expiry Date</label>
      <input type="date" id="expiryDate" required />
    </div>

    <div class="addItemsForm">
      <label for="status">Status</label>
      <select id="status">
        <option value="fresh">ğŸŸ¢ Fresh</option>
        <option value="near_expiry">ğŸŸ¡ Near Expiry</option>
        <option value="expired">ğŸ”´ Expired</option>
      </select>
    </div>

    <div class="addItemsForm">
      <label for="notes">Notes (optional)</label>
      <textarea id="notes" placeholder="Add notes regarding food item..."></textarea>
    </div>

    <button type="submit" class="btn-submit">Save Item</button>
  </form>
</section>
<!-- footer part -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>FoodGuard</h4>
                <p>Your smart companion for managing food and reducing waste.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="add.html">Add Item</a></li>
                    <li><a href="items.html">All Items</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Contact</h4>
                <p>Email: info@FoodGuard.com</p>
                <p>Phone: +1 (555) 123-4567</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 FoodGuard All rights reserved.</p>
        </div>
    </footer>
    <script>
             // here we are getting getting the info whether user is logged in or not  if not then redirect him to login page first to login first 
          const loggedInUser = localStorage.getItem('isLoggedIn').trim();
        if(!loggedInUser) {
        window.location.href = "index.html";
        }
    const itemName = document.getElementById('itemName');
 
    
    const category = document.getElementById('category');
    const quantity = document.getElementById('quantity');

    // .max is used to set the maximum value to be allow to filled 
    quantity.max = 1000; 
    const expiryDate = document.getElementById('expiryDate');
    // dont let user  choose the expiry date before current date 
      expiryDate.min = new Date().toISOString().split("T")[0];
    const status = document.getElementById('status');
    const notes = document.getElementById('notes');
    const addItemForm = document.getElementById('addItemForm');

    // check for inputs other than letters and spaces in the item name 
    addItemForm.addEventListener('submit' , function(event) {
            event.preventDefault();
         if(/^[A-Za-z\s]+$/.test(itemName.value)===false){
        alert("Item name should only contain letters and spaces.");
        itemName.value="";
        return;
         }
        const userData = JSON.parse(localStorage.getItem(loggedInUser));
        if (!userData) {
            alert("Error: User data not found. Please log in again.");
            window.location.href = "index.html"; 
            return; 
        }
        if(!Array.isArray(userData.foods)){
            userData.foods = [];
        }
        const items = userData.foods;
        // check for duplicates item names 
        for(let i=0;i<items.length;i++){
            if(items[i].name.toLowerCase()===itemName.value.toLowerCase()){
                alert("Item with this name already exists.");
                itemName.value="";
                return;
            }
        }
    

      const newItem = {
        id: Date.now(),
        name: itemName.value,
        category: category.value,
        quantity: parseInt(quantity.value),
        expiryDate: expiryDate.value,
        status: status.value,
        notes: notes.value
      };
   
      userData.foods.push(newItem);
      localStorage.setItem(loggedInUser, JSON.stringify(userData));
      alert('Item added successfully!');
      addItemForm.reset();
    });
    </script>
</body>
</html>